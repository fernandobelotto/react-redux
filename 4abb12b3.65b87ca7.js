(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{147:function(e,o,t){"use strict";t.d(o,"a",(function(){return u})),t.d(o,"b",(function(){return b}));var n=t(0),a=t.n(n);function r(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function c(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),t.push.apply(t,n)}return t}function s(e){for(var o=1;o<arguments.length;o++){var t=null!=arguments[o]?arguments[o]:{};o%2?c(Object(t),!0).forEach((function(o){r(e,o,t[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))}))}return e}function i(e,o){if(null==e)return{};var t,n,a=function(e,o){if(null==e)return{};var t,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],o.indexOf(t)>=0||(a[t]=e[t]);return a}(e,o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],o.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var d=a.a.createContext({}),p=function(e){var o=a.a.useContext(d),t=o;return e&&(t="function"==typeof e?e(o):s(s({},o),e)),t},u=function(e){var o=p(e.components);return a.a.createElement(d.Provider,{value:o},e.children)},l={inlineCode:"code",wrapper:function(e){var o=e.children;return a.a.createElement(a.a.Fragment,{},o)}},m=a.a.forwardRef((function(e,o){var t=e.components,n=e.mdxType,r=e.originalType,c=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=p(t),m=n,b=u["".concat(c,".").concat(m)]||u[m]||l[m]||r;return t?a.a.createElement(b,s(s({ref:o},d),{},{components:t})):a.a.createElement(b,s({ref:o},d))}));function b(e,o){var t=arguments,n=o&&o.mdxType;if("string"==typeof e||n){var r=t.length,c=new Array(r);c[0]=m;var s={};for(var i in o)hasOwnProperty.call(o,i)&&(s[i]=o[i]);s.originalType=e,s.mdxType="string"==typeof e?e:n,c[1]=s;for(var d=2;d<r;d++)c[d]=t[d];return a.a.createElement.apply(null,c)}return a.a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},84:function(e,o,t){"use strict";t.r(o),t.d(o,"frontMatter",(function(){return c})),t.d(o,"metadata",(function(){return s})),t.d(o,"rightToc",(function(){return i})),t.d(o,"default",(function(){return p}));var n=t(2),a=t(6),r=(t(0),t(147)),c={id:"accessing-store",title:"Acessando a store",hide_title:!0,sidebar_label:"Acessando a store"},s={unversionedId:"using-react-redux/accessing-store",id:"version-7.2/using-react-redux/accessing-store",isDocsHomePage:!1,title:"Acessando a store",description:"Acessando a store",source:"@site/versioned_docs\\version-7.2\\using-react-redux\\accessing-store.md",slug:"/using-react-redux/accessing-store",permalink:"/react-redux/using-react-redux/accessing-store",version:"7.2",sidebar_label:"Acessando a store",sidebar:"version-7.2/docs",previous:{title:"Connect: Despachando Actions com mapDispatchToProps",permalink:"/react-redux/using-react-redux/connect-mapdispatch"},next:{title:"Tipagem Est\xe1tica",permalink:"/react-redux/using-react-redux/static-typing"}},i=[{value:"Usando o hook <code>useStore</code>",id:"usando-o-hook-usestore",children:[]},{value:"Compreendendo o uso do Context",id:"compreendendo-o-uso-do-context",children:[]},{value:"Fornecendo um Context personalizado",id:"fornecendo-um-context-personalizado",children:[]},{value:"Multiplas Stores",id:"multiplas-stores",children:[]},{value:"Usando <code>ReactReduxContext</code> diretamente",id:"usando-reactreduxcontext-diretamente",children:[]},{value:"Recursos Adicionais",id:"recursos-adicionais",children:[]}],d={rightToc:i};function p(e){var o=e.components,t=Object(a.a)(e,["components"]);return Object(r.b)("wrapper",Object(n.a)({},d,t,{components:o,mdxType:"MDXLayout"}),Object(r.b)("h1",{id:"acessando-a-store"},"Acessando a store"),Object(r.b)("p",null,"React Redux fornece APIs que permitem que seus componentes despachem actions e assinem atualiza\xe7\xf5es de dados da store."),Object(r.b)("p",null,"Como parte disso, o React Redux abstrai os detalhes de qual store voc\xea est\xe1 usando e os detalhes exatos de como essa intera\xe7\xe3o\ncom a store \xe9 tratada. No uso normal, seus pr\xf3prios componentes nunca devem se preocupar com esses detalhes, e\nnunca far\xe1 refer\xeancia \xe0 store diretamente. React Redux tamb\xe9m lida internamente com os detalhes de como a store e o estado s\xe3o\npropagado para os componentes conectados, para que funcione conforme o esperado por padr\xe3o."),Object(r.b)("p",null,"No entanto, pode haver certos casos de uso em que voc\xea pode precisar personalizar como o armazenamento e o estado s\xe3o propagados para\ncomponentes conectados ou acessar a store diretamente. Aqui est\xe3o alguns exemplos de como fazer isso."),Object(r.b)("h2",{id:"usando-o-hook-usestore"},"Usando o hook ",Object(r.b)("inlineCode",{parentName:"h2"},"useStore")),Object(r.b)("p",null,"O ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/react-redux/api/hooks#useStore"}),"hook ",Object(r.b)("inlineCode",{parentName:"a"},"useStore"))," retorna a inst\xe2ncia de store atual do ",Object(r.b)("inlineCode",{parentName:"p"},"ReactReduxContext")," padr\xe3o. Se voc\xea realmente precisa acessar a store, esta \xe9 a abordagem recomendada."),Object(r.b)("h2",{id:"compreendendo-o-uso-do-context"},"Compreendendo o uso do Context"),Object(r.b)("p",null,"Internamente, o React Redux usa o ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://reactjs.org/docs/context.html"}),'recurso de "context" do React')," para fazer o\nRedux store acess\xedvel para componentes conectados profundamente aninhados. A partir do React Redux vers\xe3o 6, isso normalmente \xe9 tratado\npor uma \xfanica inst\xe2ncia do objeto de context padr\xe3o gerado por ",Object(r.b)("inlineCode",{parentName:"p"},"React.createContext()"),", chamado ",Object(r.b)("inlineCode",{parentName:"p"},"ReactReduxContext"),"."),Object(r.b)("p",null,"O componente ",Object(r.b)("inlineCode",{parentName:"p"},"<Provider>")," do React Redux usa ",Object(r.b)("inlineCode",{parentName:"p"},"<ReactReduxContext.Provider>")," para colocar a Redux store e o estado atual da store no context, e ",Object(r.b)("inlineCode",{parentName:"p"},"connect")," usa",Object(r.b)("inlineCode",{parentName:"p"}," <ReactReduxContext.Consumer>")," para ler esses valores e lidar com as atualiza\xe7\xf5es."),Object(r.b)("h2",{id:"fornecendo-um-context-personalizado"},"Fornecendo um Context personalizado"),Object(r.b)("p",null,"Em vez de usar a inst\xe2ncia de contexto padr\xe3o do React Redux, voc\xea pode fornecer sua pr\xf3pria inst\xe2ncia de context personalizada."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"<Provider context={MyContext} store={store}>\n  <App />\n</Provider>\n")),Object(r.b)("p",null,"Se voc\xea fornecer um context personalizado, o React Redux usar\xe1 essa inst\xe2ncia de context em vez daquela que ele cria e exporta por padr\xe3o."),Object(r.b)("p",null,"Depois de fornecer o contexto personalizado para ",Object(r.b)("inlineCode",{parentName:"p"},"<Provider />"),", voc\xea precisar\xe1 fornecer esta inst\xe2ncia de context para todos os seus componentes conectados que devem se conectar \xe0 mesma store:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"// Voc\xea pode passar o context como uma op\xe7\xe3o para connect\nexport default connect(\n  mapState,\n  mapDispatch,\n  null,\n  { context: MyContext }\n)(MyComponent)\n\n// ou ligue a conex\xe3o normalmente para come\xe7ar\nconst ConnectedComponent = connect(\n  mapState,\n  mapDispatch\n)(MyComponent)\n\n// Posteriormente, passe o context personalizado como um suporte para o componente conectado\n<ConnectedComponent context={MyContext} />\n")),Object(r.b)("p",null,"O seguinte erro de tempo de execu\xe7\xe3o ocorre quando o React Redux n\xe3o encontra uma store no context que est\xe1 procurando. Por exemplo:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Voc\xea forneceu uma inst\xe2ncia de context personalizado para ",Object(r.b)("inlineCode",{parentName:"li"},"<Provider />"),", mas n\xe3o forneceu a mesma inst\xe2ncia (ou n\xe3o forneceu nenhuma) para seus componentes conectados."),Object(r.b)("li",{parentName:"ul"},"Voc\xea forneceu um context personalizado para seu componente conectado, mas n\xe3o forneceu a mesma inst\xe2ncia (ou n\xe3o forneceu nenhuma) para ",Object(r.b)("inlineCode",{parentName:"li"},"<Provider />"),".")),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"Invariant Violation"),Object(r.b)("p",{parentName:"blockquote"},'Could not find "store" in the context of "Connect(MyComponent)". Either wrap the root component in a ',Object(r.b)("inlineCode",{parentName:"p"},"<Provider>"),", or pass a custom React context provider to ",Object(r.b)("inlineCode",{parentName:"p"},"<Provider>")," and the corresponding React context consumer to Connect(Todo) in connect options.")),Object(r.b)("h2",{id:"multiplas-stores"},"Multiplas Stores"),Object(r.b)("p",null,Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://redux.js.org/api/store#a-note-for-flux-users"}),"Redux foi projetado para usar uma \xfanica loja"),".\nNo entanto, se voc\xea est\xe1 em uma posi\xe7\xe3o inevit\xe1vel de precisar usar v\xe1rias lojas, com a v6, voc\xea pode fazer isso fornecendo (v\xe1rios) contexts personalizados.\nIsso tamb\xe9m fornece um isolamento natural das stores, pois elas vivem em inst\xe2ncias de contexto separadas."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"// um exemplo ing\xeanuo\nconst ContextA = React.createContext();\nconst ContextB = React.createContext();\n\n// assumindo que reducerA e reducerB s\xe3o fun\xe7\xf5es reducers adequadas\nconst storeA = createStore(reducerA);\nconst storeB = createStore(reducerB);\n\n// fornece as inst\xe2ncias de context para o Provider\nfunction App() {\n  return (\n    <Provider store={storeA} context={ContextA} />\n      <Provider store={storeB} context={ContextB}>\n        <RootModule />\n      </Provider>\n    </Provider>\n  );\n}\n\n// busca a store correspondente com componentes conectados\n// voc\xea precisa usar o context correto\nconnect(mapStateA, null, null, { context: ContextA })(MyComponentA)\n\n// Voc\xea tamb\xe9m pode passar a inst\xe2ncia de context alternativo diretamente para o componente conectado\n<ConnectedMyComponentA context={ContextA} />\n\n// \xe9 poss\xedvel usar connect() em cadeia\n// neste caso, MyComponent receber\xe1 props mesclados de ambas as stores\ncompose(\n  connect(mapStateA, null, null, { context: ContextA }),\n  connect(mapStateB, null, null, { context: ContextB })\n)(MyComponent);\n")),Object(r.b)("h2",{id:"usando-reactreduxcontext-diretamente"},"Usando ",Object(r.b)("inlineCode",{parentName:"h2"},"ReactReduxContext")," diretamente"),Object(r.b)("p",null,"Em casos raros, voc\xea pode precisar acessar a store Redux diretamente em seus pr\xf3prios componentes. Isso pode ser feito renderizando\no consumidor de context apropriado, e acessando o campo ",Object(r.b)("inlineCode",{parentName:"p"},"store")," fora do valor de context."),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},Object(r.b)("strong",{parentName:"p"},"Nota"),": Isso ",Object(r.b)("strong",{parentName:"p"},Object(r.b)("em",{parentName:"strong"},"n\xe3o")," \xe9 considerado parte da API p\xfablica do React Redux e pode falhar sem aviso pr\xe9vio"),". N\xf3s reconhecemos\nque a comunidade tem casos de uso onde isso \xe9 necess\xe1rio e tentar\xe1 possibilitar que os usu\xe1rios criem\nfuncionalidade em cima do React Redux, mas nosso uso espec\xedfico de context \xe9 considerado um detalhe de implementa\xe7\xe3o.\nSe voc\xea tiver casos de uso adicionais que n\xe3o s\xe3o suficientemente cobertos pelas APIs atuais, registre um problema para discutir\nposs\xedveis melhorias de API.")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"import { ReactReduxContext } from 'react-redux'\n\n// em seu componente conectado\nfunction MyConnectedComponent() {\n  return (\n    <ReactReduxContext.Consumer>\n      {({ store }) => {\n        // fa\xe7a algo \xfatil com a store, como pass\xe1-la para uma componente child\n        // onde pode ser usado em m\xe9todos de lifecycle\n      }}\n    </ReactReduxContext.Consumer>\n  )\n}\n")),Object(r.b)("h2",{id:"recursos-adicionais"},"Recursos Adicionais"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Exemplo no CodeSandbox: ",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://codesandbox.io/s/92pm9n2kl4"}),"Um aplicativo de lista de leitura com tema usando uma store separada"),", implementado fornecendo (m\xfaltiplos) contexts personalizados."),Object(r.b)("li",{parentName:"ul"},"Assuntos relacionados:",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/reduxjs/react-redux/issues/1132"}),"#1132: Update docs for using a different store key")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/reduxjs/react-redux/issues/1126"}),"#1126: ",Object(r.b)("inlineCode",{parentName:"a"},"<Provider>")," misses state changes that occur between when its constructor runs and when it mounts"))))))}p.isMDXComponent=!0}}]);